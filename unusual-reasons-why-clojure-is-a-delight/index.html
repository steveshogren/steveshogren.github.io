<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Six Unusual Reasons why Clojure is a Delight  &middot; Deliberate Software</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="">


<meta property="og:title" content="Six Unusual Reasons why Clojure is a Delight  &middot; Deliberate Software ">
<meta property="og:site_name" content="Deliberate Software"/>
<meta property="og:url" content="http://deliberate-software.com/unusual-reasons-why-clojure-is-a-delight/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2015-02-09T00:00:00Z" />
<meta property="og:article:modified_time" content="2015-02-09T00:00:00Z" />

  
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@steveshogren" />
<meta name="twitter:creator" content="@steveshogren" />
<meta name="twitter:title" content="Six Unusual Reasons why Clojure is a Delight" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="http://deliberate-software.com/unusual-reasons-why-clojure-is-a-delight/" />
<meta name="twitter:domain" content="http://deliberate-software.com/">
  
<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Six Unusual Reasons why Clojure is a Delight",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2015-02-09",
    "description": "",
    "wordCount":  1245 
  }
</script>



<link rel="canonical" href="http://deliberate-software.com/unusual-reasons-why-clojure-is-a-delight/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://deliberate-software.com/touch-icon-144-precomposed.png">
<link href="http://deliberate-software.com/favicon.png" rel="icon">

<meta name="generator" content="Hugo 0.15" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->


    <link rel="stylesheet" href="http://deliberate-software.com/css/fontimport.css">




    <link rel="stylesheet" href="http://deliberate-software.com/css/theme/yeti.css">


<link rel="stylesheet" href="http://deliberate-software.com/css/font-awesome.min.css">
<link rel="stylesheet" href="http://deliberate-software.com/css/style.css">


  <link rel="stylesheet" href="http://deliberate-software.com/css/highlight/default.css">


</head>
<body class="map[name:yeti]">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header ">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://deliberate-software.com/">Deliberate Software</a>
      </div>
      <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
            <li><a href="https://www.github.com/steveshogren"><span class="fa fa-github-square"></span> GitHub</a></li>
            <li><a href="/index.xml" rel="alternate" type="application/rss+xml"> <span class="fa fa-rss-square"></span> RSS</a></li>
          
          <li>
            <a href="http://deliberate-software.com/page/books"
             title="Show list of my favorite books">
            
            Favorite Books
            </a>
          </li>
          
          <li>
            <a href="http://deliberate-software.com/page/philosophy"
             title="About me">
            
            About Me
            </a>
          </li>
          
          <li>
            <a href="http://deliberate-software.com/page/post"
             title="Show list of posts">
            
            All Posts
            </a>
          </li>
          
        </ul>
      </div>
      
    </div>
  </nav>

</header>


<div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-9 col-lg-9">
            
<div class="text-center">
  <h1 class="">Six Unusual Reasons why Clojure is a Delight
</h1>

  <a href="https://twitter.com/share" class="twitter-share-button" data-via="steveshogren" data-size="large">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

<div class="metas col-md-12">
<small>
  <i class="fa fa-calendar"></i>
  <time datetime="2015-02-09">9 Feb, 2015</time>
</small>


  <small>
  &middot; Read in about 6 min
  &middot; (1245 Words)
</small>



<div class="margin-12">
  <i class="fa fa-tags"></i>
  
  <a href="http://deliberate-software.com/categories/clojure" class="label label-default">clojure</a>
  
  <a href="http://deliberate-software.com/categories/technical-skills" class="label label-default">Technical Skills</a>
  
  <a href="http://deliberate-software.com/categories/unit-testing" class="label label-default">Unit Testing</a>
  

 </div>
<br>
</div>

</div>

            <div class="">
    
  <div class="content">
    

<p>Clojure is a delightful language, and here are six uncommonly
discussed reasons why.</p>

<h2 id="1-dead-simple-unit-test-mocking:8b20eb90a7bf5bd93e271e1b65cf0feb">1 - Dead Simple Unit Test Mocking</h2>

<p>Clojure is the easiest language to unit test I have ever
seen. &ldquo;Mocking&rdquo; a function in a test only requires a simple
replacement of the function definition. No extraneous interfaces, no
dependency injection, no mocking framework.  The built-in function <code>with-redefs</code>
will replace any function in any library or
namespace with a new definition.</p>

<pre><code class="language-clojure">(defn next-id [connection]
  (+ 1 (get-current-id connection)))

(testing &quot;next-id&quot;
  ;; bind get-current-id to a lambda that always returns 4 
  (with-redefs [get-current-id (fn [_] 4)]
    (is (= 5 (next-id nil)))))
</code></pre>

<p>We &ldquo;mock&rdquo; the <code>get-current-id</code> function to always return 4 inside
the scope of <code>with-redefs</code>. Couldn&rsquo;t be more simple! The binding
only is in scope for code inside and called by the s-expression of the
with-redefs, so no need to unbind it after the test.</p>

<h2 id="2-amazing-editing:8b20eb90a7bf5bd93e271e1b65cf0feb">2 - Amazing Editing</h2>

<p>Many arguments have been made over those contentious
parentheses. While the most powerful use of s-expressions is to easily
allow macros, for the day to day, s-expressions have a very important
use: amazing editing!</p>

<p><img src="http://danmidwood.com/assets/animated-paredit/paredit-slurp-barf.gif"></img></p>

<p>With ParEdit (available in most editors), it is trivial to select,
move, replace, grow, or shrink any s-expression, string, map, or
list. <a href="http://danmidwood.com/content/2014/11/21/animated-paredit.html">This animated guide</a>
shows excellent examples of ParEdit that are too
complex to explain here.</p>

<p>Languages that don&rsquo;t have a surrounding delimiter for expressions
leave you jumping around with the mouse and arrow keys a whole lot more.
Because it is so much easier to write a parser to select <code>(add 1 2)</code>
than it is for <code>add(1, 2)</code>, the tooling can be so much better.</p>

<p>No local editing tool I have seen comes close to Vim with ParEdit for
effective editing.</p>

<h2 id="3-live-attached-repl:8b20eb90a7bf5bd93e271e1b65cf0feb">3 - Live Attached Repl</h2>

<p>Developing in Clojure against a running version of the program is a
huge bonus for development speed. While possible to get similar
behavior with an attached debugger in other languages, the fluidity of
an always-on live attached repl is incredible. At any point, it is
possible to run and rerun any given expression to see the
results. More than once, I have seen an exception caused by calling a
certain function. I trace that function to see the exact inputs that
cause the exception, and am able to quickly run every line of the
offending function to see the source.</p>

<p>If a debugger sheds light on a single line at a time when running an
application, a live attached repl sheds light on the entire
application.</p>

<h2 id="4-no-fuss-polymorphism:8b20eb90a7bf5bd93e271e1b65cf0feb">4 - No-fuss Polymorphism</h2>

<p>One of the best claims about &ldquo;traditional&rdquo; Java OO is
polymorphism. The ability to make an interface with concrete classes
gives the powerful ability to replace behavior dynamically. The
trouble is, Java&rsquo;s polymorphic dynamic dispatch is single dispatch - the
decision of which method to call is limited to a single thing: the
type of the callee. If this was the only type of dynamic dispatch you
ever knew of, it might be hard for you to consciously realize it was
ever a limitation, especially if you&rsquo;ve never seen examples of
multiple dispatch.</p>

<p>While most of the time, in any language with first class functions, it
is possible to achieve a similar effect by passing functions, it is
also possible to get a similar value with something called multimethods.</p>

<pre><code class="language-clojure">(defmulti speak :animal)
(defmethod speak :dog [this] (str &quot;woof says &quot; (:name this)))
(defmethod speak :cat [this] (str &quot;mow says &quot; (:name this)))

(speak {:animal :dog :id 1 :name &quot;Spike&quot;})
;; =&gt; &quot;woof says Spike&quot;
(speak {:animal :cat :id 2 :name &quot;Mr Cat&quot;})
;; =&gt; &quot;mow says Mr Cat&quot;
</code></pre>

<p>In this example, we use the <code>:animal</code> keyword to be the &ldquo;route&rdquo; function,
and the two methods fill in two of the possible concrete types. We are
not limited to just a keyword, we can dispatch on anything on the
passed map, for example, the oddness of the id:</p>

<pre><code class="language-clojure">(defmulti odds? (comp odd? :id))
(defmethod odds? true [d] &quot;odd id&quot;)
(defmethod odds? false [c] &quot;even id&quot;)

(odds? {:animal :dog :id 1 :name &quot;Spike&quot;})
;; =&gt; &quot;odd id&quot;
(odds? {:animal :cat :id 2 :name &quot;Mr Cat&quot;})
;; =&gt; &quot;even id&quot;
</code></pre>

<p>While both examples are a bit silly, they should demonstrate the power
of simple polymorphism. But you might think, what about inheritance?
Multimethods allow that too!</p>

<h2 id="5-simple-multiple-inheritance:8b20eb90a7bf5bd93e271e1b65cf0feb">5 - Simple Multiple Inheritance</h2>

<p>We don&rsquo;t build inheritance on a single type, but on a hierarchy of
keywords. Those can be dispatched on just like any other
keyword. First, an example hierarchy of keywords using the built-in
functions <code>derive</code> and <code>isa?</code>. These <code>::</code> keywords are
namespaced, which prevents collisions.</p>

<pre><code class="language-clojure">(derive ::cat ::mammal)
(derive ::dog ::mammal)
(derive ::dog ::hairy)
(derive ::poodle ::dog)

(isa? ::poodle ::dog)
;; =&gt; true
(isa? ::poodle ::mammal)
;; =&gt; true
(isa? ::poodle ::hairy)
;; =&gt; true
(isa? ::poodle ::cat)
;; =&gt; false
(isa? ::mammal ::hairy)
;; =&gt; false
</code></pre>

<p>A <code>::dog</code> is-a <code>::mammal</code> and is-a <code>::hairy</code>, the
classical diamond problem (without the common ancestor, which is
possible, but unneeded for the example).</p>

<pre><code class="language-clojure">(defmulti speak :animal)
(defmethod speak ::poodle [d] &quot;chirps&quot;)
(defmethod speak ::mammal [c] &quot;breathes&quot;)

(speak {:animal ::poodle :id 1 :name &quot;Spike&quot;})
;; =&gt; &quot;chirps&quot;
(speak {:animal ::dog :id 2 :name &quot;Mr Dog&quot;})
;; =&gt; &quot;breathes&quot;

(defmulti shave :animal)
(defmethod shave ::poodle [d] &quot;shivers&quot;)
(defmethod shave ::hairy [c] &quot;stuggles&quot;)
(defmethod shave ::mammal [c] &quot;maybe cant be shaved!&quot;)
(prefer-method shave ::hairy ::mammal)

(shave {:animal ::poodle :id 1 :name &quot;Spike&quot;})
;; =&gt; &quot;shivers&quot;
(shave {:animal ::dog :id 2 :name &quot;Rufs&quot;})
;; =&gt; &quot;stuggles&quot;
</code></pre>

<p>We can see the <code>::dog</code> keyword doesn&rsquo;t have an explicit speak or shave
implementation, which is fine, because it will then use the &ldquo;preferred&rdquo;
parent implementation, which returns &ldquo;breathes&rdquo; for speak or
&ldquo;struggles&rdquo; for shave. Since we can have a keyword be the child of
multiple parents, we get a multiple inherited behavior, where the
preferred match is the one returned.</p>

<p>This is possible because the default equality check of multimethod is
the <code>isa?</code> function. Because of this, uses of multimethod
hierarchies can have inherited behavior for complex structures.</p>

<h2 id="6-mostly-monadic:8b20eb90a7bf5bd93e271e1b65cf0feb">6 - Mostly Monadic</h2>

<p>Languages like Haskell and F# have tools like the maybe monad that add
safety to operations. For example, using the maybe monad can
completely prevent null reference exceptions by making you ensure you
&ldquo;unpack&rdquo; the value every time.</p>

<p>How does Clojure address this? In a typical Clojure way, which gives
80% of the value for 20% of the effort, Clojure has a great
relationship with empty lists and nil. Rather than wrapping every
value that is nullable in a type, Clojure&rsquo;s default functions all
<em>mostly</em> deal with nil and empty without throwing exceptions. For
example:</p>

<pre><code class="language-clojure">(get {:id 5} :id)
;; =&gt; 5
(get nil :id)
;; =&gt; nil

(first [3 2 1])
;; =&gt; 3
(first nil)
;; =&gt; nil
(count nil)
;; =&gt; 0
</code></pre>

<p>This allows functions to be chained without fear that along the way a
nil will get returned.</p>

<p>Since most of the core functions are &ldquo;smart&rdquo; about nil, you gain much
of the value and safety of monads without most of the
hassle. Ultimately, a more rich type system would allow for custom
types which can be domain specific, but in day-to-day working,
primitive safety is still a huge win.</p>

<h2 id="conclusion:8b20eb90a7bf5bd93e271e1b65cf0feb">Conclusion</h2>

<p>These are a few simple features that keep me coming back to Clojure,
even from languages like F# and Haskell. While Clojure is a bit more
wordy than the ML family, and not as type safe, the simplicity of
these features keep me coming back for more!</p>

  </div>
</div>


            <footer>
  <div class="centereded">
    <a href="https://twitter.com/share" class="twitter-share-button" data-via="steveshogren" data-size="large">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

</div>
<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    
        <li class="previous">
          <a href="http://deliberate-software.com/christmas-f-number-polymorphism/" title="Christmas F# Polymorphism">
            <span aria-hidden="true">&larr;</span>Previous
          </a>
        </li>
    

    
      <li class="next">
        <a href="http://deliberate-software.com/programming-language-safety-algorithm/" title="Programming Language Safety Ranking">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  

</div>

</footer>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 col-xl-3">
            <h3 class="serif col-sm-12 centereded" id="name">Steve Shogren</h3>
<span class="col-xs-3 col-sm-4 col-md-3"></span>
<img class="col-xs-6 col-sm-4 col-md-6 border" id="avatar" src="http://deliberate-software.com//images/me_updated3.png" />
<span class="col-xs-3 col-sm-4 col-md-3"></span>
<span class="col-xs-12 col-sm-12 col-md-12 centereded">
  <a href="https://twitter.com/steveshogren" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @steveshogren</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
</span>
<span class="col-xs-12 col-sm-12">
    Insights gathered while learning to deliberately craft software.
</span>
<h3 class="col-xs-12 col-sm-12 centereded" id="name">Too many great ideas? Check out my new book!</h3>

<a class="col-xs-12 col-sm-12 centereded" href="https://leanpub.com/convincingcoworkers">
    <img class="book" src="/images/convincingcoworkerscover.jpg"></img>
</a>

<h3 class="col-xs-12 col-sm-12" id="name">Top Posts</h3>
<div class="col-xs-12 col-sm-12">
    <ul class="sidebar_ul">
        
        <li class="sidebar_li"><a href="http://deliberate-software.com/haskell-is-the-dark-souls-of-programming/">Haskell is the Dark Souls of Programming</a></li>
        
        <li class="sidebar_li"><a href="http://deliberate-software.com/on-defeat/">Interview Humiliation</a></li>
        
        <li class="sidebar_li"><a href="http://deliberate-software.com/unusual-reasons-why-clojure-is-a-delight/">Six Unusual Reasons why Clojure is a Delight</a></li>
        
        <li class="sidebar_li"><a href="http://deliberate-software.com/function-pattern-matching/">Pattern Matching - Making the Compiler Work For You</a></li>
        
        <li class="sidebar_li"><a href="http://deliberate-software.com/ego-driven-development/">Ego Driven Development</a></li>
        
    </ul>
</div>
<h3 class="col-xs-12 col-sm-12" id="name">Categories</h3>
<div class="col-xs-12 col-sm-12">
    <ul class="sidebar_ul">
        
        <li class="sidebar_li">
            <a href="/categories/angular">angular</a> <span class="badge">2</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/architecture">architecture</a> <span class="badge">4</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/clojure">clojure</a> <span class="badge">11</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/clojurescript">clojurescript</a> <span class="badge">2</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/csharp">csharp</a> <span class="badge">5</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/emacs">emacs</a> <span class="badge">3</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/fsharp">fsharp</a> <span class="badge">7</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/haskell">haskell</a> <span class="badge">3</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/interviews">interviews</a> <span class="badge">2</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/management">management</a> <span class="badge">9</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/meta-game">meta-game</a> <span class="badge">25</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/refactoring">refactoring</a> <span class="badge">1</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/technical-skills">technical-skills</a> <span class="badge">29</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/unit-testing">unit-testing</a> <span class="badge">8</span>
        </li>
        
        <li class="sidebar_li">
            <a href="/categories/vim">vim</a> <span class="badge">2</span>
        </li>
        
    </ul>
</div>

        </div>
    </div>
</div>
      <footer class="footer">
    <div class="container hidden-print">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="#">back to top</a>
</div>
<div class="pull-right">
  
</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
          <small>
              
    

    


          </small>
        </div>
     </div>
    </div>
</footer>

    <script src="http://deliberate-software.com/js/jquery.min-2.1.4.js"></script>
<script src="http://deliberate-software.com/js/bootstrap.min-3.3.5.js"></script>




<script src="http://deliberate-software.com/js/highlight.pack.js"></script>
<script src="http://deliberate-software.com/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
if (document.location.hostname.search("deliberate-software.com") !== -1) {
  var _gaq=[['_setAccount','UA-46040901-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
}
</script>


  </body>
</html>

